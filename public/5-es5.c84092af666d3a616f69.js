!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"0eej":function(n,o,a){"use strict";a.r(o),a.d(o,"RoutePageModule",(function(){return L}));var i=a("ofXK"),s=a("3Pt+"),r=a("TEn/"),c=a("PCNd"),l=a("tyNb"),u=a("mrSG"),b=a("wd/R"),d=a("fXoL"),g=a("lGQG"),m=a("UrgT"),h=a("6c4d"),f=a("b1s6");function p(e,t){1&e&&d.Jb(0,"ion-progress-bar",6)}function v(e,t){1&e&&d.Jb(0,"app-skeleton")}function y(e,t){1&e&&d.Jb(0,"ion-icon",14)}function S(e,t){1&e&&d.Jb(0,"ion-icon",15)}function k(e,t){1&e&&d.Jb(0,"ion-icon",16)}function N(e,t){if(1&e){var n=d.Ob();d.Nb(0,"div"),d.Nb(1,"ion-item",8),d.Vb("click",(function(){d.jc(n);var e=d.Xb().$implicit;return d.Xb(2).goSaleDetail(e.sale[0])})),d.Nb(2,"ion-avatar"),d.mc(3,y,1,0,"ion-icon",9),d.mc(4,S,1,0,"ion-icon",10),d.mc(5,k,1,0,"ion-icon",11),d.Mb(),d.Nb(6,"ion-label",12),d.Nb(7,"ion-text"),d.Nb(8,"h3"),d.nc(9),d.Mb(),d.Mb(),d.Nb(10,"h3"),d.nc(11),d.Yb(12,"currency"),d.Mb(),d.Nb(13,"h3"),d.nc(14),d.Yb(15,"number"),d.Mb(),d.Mb(),d.Jb(16,"ion-icon",13),d.Mb(),d.Mb()}if(2&e){var o=d.Xb().$implicit,a=d.Xb(2);d.yb(3),d.ec("ngIf",o.sale[0].abonos[o.sale[0].abonos.length-1]&&o.sale[0].abonos[o.sale[0].abonos.length-1].createdAt!=a.today||!o.sale[0].abonos[0]),d.yb(1),d.ec("ngIf",o.sale[0].abonos[o.sale[0].abonos.length-1]&&o.sale[0].abonos[o.sale[0].abonos.length-1].createdAt==a.today&&o.sale[0].abonos[o.sale[0].abonos.length-1].monto>0),d.yb(1),d.ec("ngIf",o.sale[0].abonos[o.sale[0].abonos.length-1]&&o.sale[0].abonos[o.sale[0].abonos.length-1].createdAt==a.today&&0==o.sale[0].abonos[o.sale[0].abonos.length-1].monto),d.yb(4),d.qc("",o.name," ",o.lastName,""),d.yb(2),d.pc("Saldo Pendiente: ",d.ac(12,7,o.sale[0].saldo,"$"),""),d.yb(3),d.pc("Cuotas Pendientes: ",d.Zb(15,10,o.sale[0].cuotasPendientes),"")}}function w(e,t){if(1&e&&(d.Nb(0,"ion-item-sliding"),d.mc(1,N,17,12,"div",4),d.Mb()),2&e){var n=t.$implicit;d.yb(1),d.ec("ngIf",n&&n.sale&&n.sale[0])}}function C(e,t){if(1&e&&(d.Nb(0,"ion-list"),d.mc(1,w,2,1,"ion-item-sliding",7),d.Mb()),2&e){var n=d.Xb();d.yb(1),d.ec("ngForOf",n.customers)}}function I(e,t){if(1&e&&(d.Nb(0,"ion-item-divider"),d.Nb(1,"ion-label"),d.nc(2),d.Mb(),d.Mb()),2&e){var n=d.Xb();d.yb(2),d.pc(" Total Recaudado: ",n.totalRecaudado," ")}}function M(e,t){if(1&e){var n=d.Ob();d.Nb(0,"ion-fab",17),d.Vb("click",(function(){return d.jc(n),d.Xb().goNewSale()})),d.Nb(1,"ion-fab-button"),d.Jb(2,"ion-icon",18),d.Mb(),d.Mb()}}var O,U,x,j=[{path:"",component:(O=function(){function n(t,o,a,i,s){e(this,n),this.router=t,this.actionSheetController=o,this.authSvc=a,this.customersService=i,this.roleAutorization=s,this.loading=!1,this.today=b().format("ll"),this.totalRecaudado=0}var o,a,i;return o=n,(a=[{key:"ngOnInit",value:function(){var e=this;this.authSvc.getLoggedUser()?this.getCustomers():this.authSvc.getLoggedUser$().subscribe((function(t){e.getCustomers()}))}},{key:"goNewSale",value:function(){this.router.navigateByUrl("/new-sale")}},{key:"showOptions",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{text:"Cerrar Sesi\xf3n",icon:"log-out-outline",handler:function(){o.authSvc.logout(),o.router.navigate(["/login"])}},{text:"Cancelar",icon:"close",role:"cancel",handler:function(){console.log("Cancelar clicked")}}],this.roleAutorization.canCreateUser(this.authSvc.getLoggedUser())&&t.unshift({text:"Crear Usuario",icon:"person-add-outline",handler:function(){o.router.navigate(["/register"])}}),e.next=4,this.actionSheetController.create({header:this.authSvc.getLoggedUser().displayName||this.authSvc.getLoggedUser().email,cssClass:"my-custom-class",buttons:t});case 4:return n=e.sent,e.next=7,n.present();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getCustomers",value:function(){var e=this;this.loading=!0,Object.assign({},this.authSvc.getLoggedUser().roles).hasOwnProperty("admin")?this.customersService.getCustomersByAdmin(this.authSvc.getLoggedUser().uid).subscribe((function(t){e.customers=t.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.customers=e.customers.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),e.getSalesByCustomer(),e.loading=!1})):this.customersService.getCustomersByCobrador(this.authSvc.getLoggedUser().uid).subscribe((function(t){e.customers=t.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())})),e.getSalesByCustomer(),e.customers=e.customers.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),e.loading=!1}))}},{key:"getSalesByCustomer",value:function(){var e=this;if(this.customers&&this.customers.length>0){var t=0;this.customers.forEach((function(n){e.customersService.getSalesByCustomerId(n.id).subscribe((function(o){var a=o.map((function(e){return Object.assign({id:e.payload.doc.id},e.payload.doc.data())}));n.sale=a,++t==e.customers.length&&e.calcularRecaudo(e.customers)}))})),this.loading=!1}}},{key:"goSaleDetail",value:function(e){this.router.navigateByUrl("/sale-detail/"+e.id)}},{key:"calcularRecaudo",value:function(e){var t=this;this.customers.forEach((function(e){e.sale&&e.sale[0]&&e.sale[0].abonos&&e.sale[0].abonos[0]&&e.sale[0].abonos[e.sale[0].abonos.length-1]&&e.sale[0].abonos[e.sale[0].abonos.length-1].createdAt==t.today&&(t.totalRecaudado+=e.sale[0].abonos[e.sale[0].abonos.length-1].monto)}))}}])&&t(o.prototype,a),i&&t(o,i),n}(),O.\u0275fac=function(e){return new(e||O)(d.Ib(l.g),d.Ib(r.a),d.Ib(g.a),d.Ib(m.a),d.Ib(h.a))},O.\u0275cmp=d.Cb({type:O,selectors:[["app-route"]],decls:13,vars:5,consts:[["slot","primary"],["fill","clear",3,"click"],["slot","end","name","settings-outline"],["type","indeterminate",4,"ngIf"],[4,"ngIf"],["style","padding-bottom: 40px;padding-right: 10px;","vertical","bottom","horizontal","end","edge","","slot","fixed",3,"click",4,"ngIf"],["type","indeterminate"],[4,"ngFor","ngForOf"],[3,"click"],["name","shield-outline",4,"ngIf"],["color","success","name","shield-checkmark-outline",4,"ngIf"],["color","warning","name","shield-outline",4,"ngIf"],[2,"margin-left","12px"],["slot","end","name","chevron-forward-outline"],["name","shield-outline"],["color","success","name","shield-checkmark-outline"],["color","warning","name","shield-outline"],["vertical","bottom","horizontal","end","edge","","slot","fixed",2,"padding-bottom","40px","padding-right","10px",3,"click"],["name","add"]],template:function(e,t){1&e&&(d.Nb(0,"ion-header"),d.Nb(1,"ion-toolbar"),d.Nb(2,"ion-title"),d.nc(3,"Mi Ruta"),d.Mb(),d.Nb(4,"ion-buttons",0),d.Nb(5,"ion-button",1),d.Vb("click",(function(){return t.showOptions()})),d.Jb(6,"ion-icon",2),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(7,"ion-content"),d.mc(8,p,1,0,"ion-progress-bar",3),d.mc(9,v,1,0,"app-skeleton",4),d.mc(10,C,2,1,"ion-list",4),d.mc(11,I,3,1,"ion-item-divider",4),d.mc(12,M,3,0,"ion-fab",5),d.Mb()),2&e&&(d.yb(8),d.ec("ngIf",t.loading),d.yb(1),d.ec("ngIf",t.loading),d.yb(1),d.ec("ngIf",!t.loading&&t.roleAutorization.canReadCustomer(t.authSvc.getLoggedUser())),d.yb(1),d.ec("ngIf",t.customers&&t.customers.length>0),d.yb(1),d.ec("ngIf",t.roleAutorization.canCreateSale(t.authSvc.getLoggedUser())))},directives:[r.s,r.Q,r.P,r.i,r.h,r.t,r.p,i.l,r.D,f.a,r.B,i.k,r.z,r.v,r.d,r.A,r.O,r.w,r.q,r.r],pipes:[i.d,i.f],styles:[""]}),O)}],R=((x=function t(){e(this,t)}).\u0275mod=d.Gb({type:x}),x.\u0275inj=d.Fb({factory:function(e){return new(e||x)},imports:[[l.j.forChild(j)],l.j]}),x),L=((U=function t(){e(this,t)}).\u0275mod=d.Gb({type:U}),U.\u0275inj=d.Fb({factory:function(e){return new(e||U)},imports:[[i.c,s.e,r.R,c.a,R]]}),U)}}])}();