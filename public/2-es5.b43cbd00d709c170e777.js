!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{SUx8:function(e,o,r){"use strict";r.r(o),r.d(o,"CustomersPageModule",(function(){return A}));var i,c,s,a=r("ofXK"),u=r("3Pt+"),l=r("TEn/"),b=r("fXoL"),f=((c=function(){function e(){t(this,e),this.COLORS=["#e57373","#f06292","#ba68c8","#9575cd","#7986cb","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#81c784","#aed581","#ff8a65","#d4e157","#673ab7","#ffb74d","#a1887f","#90a4ae"],console.log("created")}return n(e,[{key:"getColor",value:function(t){return this.COLORS[Math.abs(this.toNumber(t))%this.COLORS.length]}},{key:"toNumber",value:function(t){for(var e=0,n=0;n<t.length;n++)e=31*e+t.charCodeAt(n),e|=0;return e}}]),e}()).\u0275fac=function(t){return new(t||c)},c.\u0275prov=b.Eb({token:c,factory:c.\u0275fac}),c),d=((i=function e(){t(this,e)}).\u0275mod=b.Gb({type:i}),i.\u0275inj=b.Fb({factory:function(t){return new(t||i)},providers:[f],imports:[[a.c]]}),i),g=r("PCNd"),m=r("tyNb"),h=r("mrSG"),p=r("0Z+d"),v=r("UrgT"),y=r("lGQG"),C=r("6c4d"),x=r("b1s6"),k=((s=function(){function e(n){t(this,e),this.colorGenerator=n,this.firstLetter="",this.styles={"background-color":"#fff",color:"#000"}}return n(e,[{key:"ngOnChanges",value:function(t){var e=t.text?t.text.currentValue:null,n=t.color?t.color.currentValue:null,o=t.textColor?t.textColor.currentValue:this.styles.color;this.firstLetter=this.extractFirstCharacter(e),this.styles=Object.assign(Object.assign({},this.styles),{"background-color":this.backgroundColorHexString(n,e),color:o})}},{key:"extractFirstCharacter",value:function(t){return t.charAt(0)||""}},{key:"backgroundColorHexString",value:function(t,e){return t||this.colorGenerator.getColor(e)}}]),e}()).\u0275fac=function(t){return new(t||s)(b.Ib(f))},s.\u0275cmp=b.Cb({type:s,selectors:[["text-avatar"]],inputs:{text:"text",color:"color",textColor:"textColor"},features:[b.wb],decls:2,vars:2,consts:[[1,"u-text-avatar",3,"ngStyle"]],template:function(t,e){1&t&&(b.Nb(0,"div",0),b.nc(1),b.Mb()),2&t&&(b.ec("ngStyle",e.styles),b.yb(1),b.oc(e.firstLetter))},directives:[a.m],styles:[".u-text-avatar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;max-width:46px;max-height:46px;border-radius:500px}"]}),s);function O(t,e){1&t&&b.Jb(0,"ion-progress-bar",4)}function M(t,e){1&t&&b.Jb(0,"app-skeleton")}function w(t,e){if(1&t){var n=b.Ob();b.Nb(0,"ion-item-options",11),b.Nb(1,"ion-item-option",12),b.Vb("click",(function(){b.jc(n);var t=b.Xb().$implicit;return b.Xb(2).deleteCustomer(t)})),b.Jb(2,"ion-icon",13),b.Mb(),b.Mb()}}function N(t,e){if(1&t){var n=b.Ob();b.Nb(0,"ion-item-sliding"),b.Nb(1,"ion-item",6),b.Vb("click",(function(){b.jc(n);var t=e.$implicit;return b.Xb(2).goCustomerDetail(t)})),b.Nb(2,"ion-avatar",7),b.Jb(3,"text-avatar",8),b.Mb(),b.Nb(4,"ion-label"),b.Nb(5,"ion-text"),b.Nb(6,"h3"),b.nc(7),b.Mb(),b.Mb(),b.Nb(8,"p"),b.nc(9),b.Mb(),b.Mb(),b.Jb(10,"ion-icon",9),b.Mb(),b.mc(11,w,3,0,"ion-item-options",10),b.Mb()}if(2&t){var o=e.$implicit,r=b.Xb(2);b.yb(3),b.ec("text",o.name),b.yb(4),b.qc("",o.name," ",o.lastName,""),b.yb(2),b.oc(o.reference),b.yb(2),b.ec("ngIf",r.roleAutorization.canDeleteCustomer(r.authSvc.getLoggedUser()))}}function S(t,e){if(1&t&&(b.Nb(0,"ion-list"),b.mc(1,N,12,5,"ion-item-sliding",5),b.Mb()),2&t){var n=b.Xb();b.yb(1),b.ec("ngForOf",n.customers)}}function j(t,e){if(1&t){var n=b.Ob();b.Nb(0,"div",14),b.Nb(1,"ion-button",15),b.Vb("click",(function(){return b.jc(n),b.Xb().createCustomer()})),b.nc(2,"Crear Cliente"),b.Mb(),b.Mb()}}var I,L,P,U=[{path:"",component:(I=function(){function e(n,o,r,i,c,s){t(this,e),this.customersService=n,this.alertController=o,this.router=r,this.authSvc=i,this.modalController=c,this.roleAutorization=s,this.loading=!1}return n(e,[{key:"ngOnInit",value:function(){var t=this;this.authSvc.getLoggedUser()?this.getCustomers():this.authSvc.getLoggedUser$().subscribe((function(e){t.getCustomers()}))}},{key:"getCustomers",value:function(){var t=this;this.loading=!0,Object.assign({},this.authSvc.getLoggedUser().roles).hasOwnProperty("admin")?this.customersService.getCustomersByAdmin(this.authSvc.getLoggedUser().uid).subscribe((function(e){t.customers=e.map((function(t){return Object.assign({id:t.payload.doc.id},t.payload.doc.data())})),t.customers=t.customers.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),t.loading=!1})):this.customersService.getCustomersByCobrador(this.authSvc.getLoggedUser().uid).subscribe((function(e){t.customers=e.map((function(t){return Object.assign({id:t.payload.doc.id},t.payload.doc.data())})),t.customers=t.customers.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),t.loading=!1}))}},{key:"goCustomerDetail",value:function(t){this.router.navigateByUrl("/customer-detail/"+t.id)}},{key:"createCustomer",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:p.a});case 2:return e=t.sent,t.next=5,e.present();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"deleteCustomer",value:function(t){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Eliminar Cliente!",message:"El cliente ser\xe1 eliminado ",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(t){console.log("Cancelar")}},{text:"Ok",handler:function(){o.customersService.deleteCustomer(t.id).then((function(t){return o.getCustomers()}))}}]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}}]),e}(),I.\u0275fac=function(t){return new(t||I)(b.Ib(v.a),b.Ib(l.b),b.Ib(m.g),b.Ib(y.a),b.Ib(l.T),b.Ib(C.a))},I.\u0275cmp=b.Cb({type:I,selectors:[["app-customers"]],decls:9,vars:4,consts:[[1,"customer-page"],["type","indeterminate",4,"ngIf"],[4,"ngIf"],["class","ion-text-center",4,"ngIf"],["type","indeterminate"],[4,"ngFor","ngForOf"],[3,"click"],["slot","start"],[3,"text"],["slot","end","name","chevron-forward-outline"],["side","end",4,"ngIf"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"],[1,"ion-text-center"],["expand","round",3,"click"]],template:function(t,e){1&t&&(b.Nb(0,"ion-header"),b.Nb(1,"ion-toolbar"),b.Nb(2,"ion-title"),b.nc(3,"Clientes"),b.Mb(),b.Mb(),b.Mb(),b.Nb(4,"ion-content",0),b.mc(5,O,1,0,"ion-progress-bar",1),b.mc(6,M,1,0,"app-skeleton",2),b.mc(7,S,2,1,"ion-list",2),b.mc(8,j,3,0,"div",3),b.Mb()),2&t&&(b.yb(5),b.ec("ngIf",e.loading),b.yb(1),b.ec("ngIf",e.loading),b.yb(1),b.ec("ngIf",!e.loading&&e.roleAutorization.canReadCustomer(e.authSvc.getLoggedUser())),b.yb(1),b.ec("ngIf",!e.loading&&e.roleAutorization.canReadCustomer(e.authSvc.getLoggedUser())))},directives:[l.s,l.Q,l.P,l.p,a.l,l.D,x.a,l.B,a.k,l.z,l.v,l.d,k,l.A,l.O,l.t,l.y,l.x,l.h],styles:[".customer-page[_ngcontent-%COMP%]   .custom-skeleton[_ngcontent-%COMP%]   ion-skeleton-text[_ngcontent-%COMP%]{line-height:13px}.customer-page[_ngcontent-%COMP%]   .custom-skeleton[_ngcontent-%COMP%]   ion-skeleton-text[_ngcontent-%COMP%]:last-child{margin-bottom:5px}"]}),I)}],R=((P=function e(){t(this,e)}).\u0275mod=b.Gb({type:P}),P.\u0275inj=b.Fb({factory:function(t){return new(t||P)},imports:[[m.j.forChild(U)],m.j]}),P),A=((L=function e(){t(this,e)}).\u0275mod=b.Gb({type:L}),L.\u0275inj=b.Fb({factory:function(t){return new(t||L)},imports:[[a.c,u.e,l.R,R,d,u.l,g.a]]}),L)}}])}();