(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{SUx8:function(t,e,o){"use strict";o.r(e),o.d(e,"CustomersPageModule",(function(){return k}));var n=o("ofXK"),r=o("3Pt+"),s=o("TEn/"),i=o("fXoL");let c=(()=>{class t{constructor(){this.COLORS=["#e57373","#f06292","#ba68c8","#9575cd","#7986cb","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#81c784","#aed581","#ff8a65","#d4e157","#673ab7","#ffb74d","#a1887f","#90a4ae"],console.log("created")}getColor(t){return this.COLORS[Math.abs(this.toNumber(t))%this.COLORS.length]}toNumber(t){let e=0;for(let o=0;o<t.length;o++)e=31*e+t.charCodeAt(o),e|=0;return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Eb({token:t,factory:t.\u0275fac}),t})(),a=(()=>{class t{}return t.\u0275mod=i.Gb({type:t}),t.\u0275inj=i.Fb({factory:function(e){return new(e||t)},providers:[c],imports:[[n.c]]}),t})();var l=o("PCNd"),u=o("tyNb"),b=o("mrSG"),d=o("0Z+d"),g=o("UrgT"),m=o("lGQG"),h=o("6c4d"),f=o("b1s6");let p=(()=>{class t{constructor(t){this.colorGenerator=t,this.firstLetter="",this.styles={"background-color":"#fff",color:"#000"}}ngOnChanges(t){let e=t.text?t.text.currentValue:null,o=t.color?t.color.currentValue:null,n=t.textColor?t.textColor.currentValue:this.styles.color;this.firstLetter=this.extractFirstCharacter(e),this.styles=Object.assign(Object.assign({},this.styles),{"background-color":this.backgroundColorHexString(o,e),color:n})}extractFirstCharacter(t){return t.charAt(0)||""}backgroundColorHexString(t,e){return t||this.colorGenerator.getColor(e)}}return t.\u0275fac=function(e){return new(e||t)(i.Ib(c))},t.\u0275cmp=i.Cb({type:t,selectors:[["text-avatar"]],inputs:{text:"text",color:"color",textColor:"textColor"},features:[i.wb],decls:2,vars:2,consts:[[1,"u-text-avatar",3,"ngStyle"]],template:function(t,e){1&t&&(i.Nb(0,"div",0),i.nc(1),i.Mb()),2&t&&(i.ec("ngStyle",e.styles),i.yb(1),i.oc(e.firstLetter))},directives:[n.m],styles:[".u-text-avatar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;max-width:46px;max-height:46px;border-radius:500px}"]}),t})();function C(t,e){1&t&&i.Jb(0,"ion-progress-bar",4)}function y(t,e){1&t&&i.Jb(0,"app-skeleton")}function v(t,e){if(1&t){const t=i.Ob();i.Nb(0,"ion-item-options",11),i.Nb(1,"ion-item-option",12),i.Vb("click",(function(){i.jc(t);const e=i.Xb().$implicit;return i.Xb(2).deleteCustomer(e)})),i.Jb(2,"ion-icon",13),i.Mb(),i.Mb()}}function x(t,e){if(1&t){const t=i.Ob();i.Nb(0,"ion-item-sliding"),i.Nb(1,"ion-item",6),i.Vb("click",(function(){i.jc(t);const o=e.$implicit;return i.Xb(2).goCustomerDetail(o)})),i.Nb(2,"ion-avatar",7),i.Jb(3,"text-avatar",8),i.Mb(),i.Nb(4,"ion-label"),i.Nb(5,"ion-text"),i.Nb(6,"h3"),i.nc(7),i.Mb(),i.Mb(),i.Nb(8,"p"),i.nc(9),i.Mb(),i.Mb(),i.Jb(10,"ion-icon",9),i.Mb(),i.mc(11,v,3,0,"ion-item-options",10),i.Mb()}if(2&t){const t=e.$implicit,o=i.Xb(2);i.yb(3),i.ec("text",t.name),i.yb(4),i.qc("",t.name," ",t.lastName,""),i.yb(2),i.oc(t.reference),i.yb(2),i.ec("ngIf",o.roleAutorization.canDeleteCustomer(o.authSvc.getLoggedUser()))}}function O(t,e){if(1&t&&(i.Nb(0,"ion-list"),i.mc(1,x,12,5,"ion-item-sliding",5),i.Mb()),2&t){const t=i.Xb();i.yb(1),i.ec("ngForOf",t.customers)}}function M(t,e){if(1&t){const t=i.Ob();i.Nb(0,"div",14),i.Nb(1,"ion-button",15),i.Vb("click",(function(){return i.jc(t),i.Xb().createCustomer()})),i.nc(2,"Crear Cliente"),i.Mb(),i.Mb()}}const N=[{path:"",component:(()=>{class t{constructor(t,e,o,n,r,s){this.customersService=t,this.alertController=e,this.router=o,this.authSvc=n,this.modalController=r,this.roleAutorization=s,this.loading=!1}ngOnInit(){this.authSvc.getLoggedUser()?this.getCustomers():this.authSvc.getLoggedUser$().subscribe(t=>{this.getCustomers()})}getCustomers(){this.loading=!0,Object.assign({},this.authSvc.getLoggedUser().roles).hasOwnProperty("admin")?this.customersService.getCustomersByAdmin(this.authSvc.getLoggedUser().uid).subscribe(t=>{this.customers=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data())),this.customers=this.customers.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),this.loading=!1}):this.customersService.getCustomersByCobrador(this.authSvc.getLoggedUser().uid).subscribe(t=>{this.customers=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data())),this.customers=this.customers.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),this.loading=!1})}goCustomerDetail(t){this.router.navigateByUrl("/customer-detail/"+t.id)}createCustomer(){return Object(b.a)(this,void 0,void 0,(function*(){const t=yield this.modalController.create({component:d.a});return yield t.present()}))}deleteCustomer(t){return Object(b.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Eliminar Cliente!",message:"El cliente ser\xe1 eliminado ",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Cancelar")}},{text:"Ok",handler:()=>{this.customersService.deleteCustomer(t.id).then(t=>this.getCustomers())}}]});yield e.present()}))}}return t.\u0275fac=function(e){return new(e||t)(i.Ib(g.a),i.Ib(s.b),i.Ib(u.g),i.Ib(m.a),i.Ib(s.T),i.Ib(h.a))},t.\u0275cmp=i.Cb({type:t,selectors:[["app-customers"]],decls:9,vars:4,consts:[[1,"customer-page"],["type","indeterminate",4,"ngIf"],[4,"ngIf"],["class","ion-text-center",4,"ngIf"],["type","indeterminate"],[4,"ngFor","ngForOf"],[3,"click"],["slot","start"],[3,"text"],["slot","end","name","chevron-forward-outline"],["side","end",4,"ngIf"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"],[1,"ion-text-center"],["expand","round",3,"click"]],template:function(t,e){1&t&&(i.Nb(0,"ion-header"),i.Nb(1,"ion-toolbar"),i.Nb(2,"ion-title"),i.nc(3,"Clientes"),i.Mb(),i.Mb(),i.Mb(),i.Nb(4,"ion-content",0),i.mc(5,C,1,0,"ion-progress-bar",1),i.mc(6,y,1,0,"app-skeleton",2),i.mc(7,O,2,1,"ion-list",2),i.mc(8,M,3,0,"div",3),i.Mb()),2&t&&(i.yb(5),i.ec("ngIf",e.loading),i.yb(1),i.ec("ngIf",e.loading),i.yb(1),i.ec("ngIf",!e.loading&&e.roleAutorization.canReadCustomer(e.authSvc.getLoggedUser())),i.yb(1),i.ec("ngIf",!e.loading&&e.roleAutorization.canReadCustomer(e.authSvc.getLoggedUser())))},directives:[s.s,s.Q,s.P,s.p,n.l,s.D,f.a,s.B,n.k,s.z,s.v,s.d,p,s.A,s.O,s.t,s.y,s.x,s.h],styles:[".customer-page[_ngcontent-%COMP%]   .custom-skeleton[_ngcontent-%COMP%]   ion-skeleton-text[_ngcontent-%COMP%]{line-height:13px}.customer-page[_ngcontent-%COMP%]   .custom-skeleton[_ngcontent-%COMP%]   ion-skeleton-text[_ngcontent-%COMP%]:last-child{margin-bottom:5px}"]}),t})()}];let S=(()=>{class t{}return t.\u0275mod=i.Gb({type:t}),t.\u0275inj=i.Fb({factory:function(e){return new(e||t)},imports:[[u.j.forChild(N)],u.j]}),t})(),k=(()=>{class t{}return t.\u0275mod=i.Gb({type:t}),t.\u0275inj=i.Fb({factory:function(e){return new(e||t)},imports:[[n.c,r.e,s.R,S,a,r.l,l.a]]}),t})()}}]);